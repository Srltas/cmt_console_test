# CUBRID Migration Toolkit(CMT) Console - Test Suite

이 저장소는 CUBRID Migration Toolkit(CMT) 콘솔의 기능을 검증하기 위한 자동화된 테스트 스위트입니다. 모든 테스트는 쉘 스크립트로 작성되었으며, CMT의 명령어와 옵션에 대한 실행 결과를 예상 결과와 비교하여 성공 여부를 판정합니다.

## 주요 특징

- **자동 테스트 탐색**: `tests` 디렉터리 내의 모든 테스트 스크립트를 자동으로 찾아 실행합니다.
- **결과 비교**: CLI 출력(summary), 덤프(dump) 파일 등 결과물을 답지와 비교합니다.
- **상세 로그 및 리포트**: 모든 실행 과정은 `log/` 디렉터리에, 결과물은 `results/` 디렉터리에 상세히 기록됩니다.
- **실패 테스트 재실행**: 실패한 테스트만 모아 다시 실행할 수 있도록 failed_targets.log에 실패한 테스트를 따로 기록합니다.

## 디렉터리 구조

```
├── run_all.sh          # 마스터 테스트 실행 스크립트
├── lib/
│   └── common.sh       # 테스트에 사용되는 공통 셸 함수 라이브러리
├── build/              # 테스트할 CMT가 위치하는 디렉터리
├── tests/              # 실제 테스트 케이스가 위치하는 디렉터리
├── results/            # 각 테스트 실행 결과가 저장되는 디렉터리
├── log/                # 상세 실행 로그가 저장되는 디렉터리
└── README.md           # 프로젝트 설명 파일
```

## 사용법

**사전 요구사항**: `bash`, `expect` 유틸리티가 설치되어 있어야 합니다.

### 1. 전체 테스트 실행
저장소의 모든 테스트를 실행합니다.
```
bash ./run_all.sh
```
### 2. 특정 테스트 또는 디렉터리 실행

`-t` 옵션을 사용하여 특정 테스트 스크립트나 디렉터리 경로를 지정하여 실행할 수 있습니다.

특정 디렉터리 내의 모든 테스트 실행
```
bash ./run_all.sh -t tests/13-2/3_oracle
```

특정 테스트 파일 하나만 실행
```
bash ./run_all.sh -t tests/13-2/3_oracle/dump/110U/ss/13-2-3_oracle-dump-110U-ss.sh
```

### 3. 실패한 테스트 재실행
이전 실행에서 실패한 테스트가 있는 경우, `-f` 옵션과 `failed_targets.log` 파일 경로를 지정하여 실패한 테스트만 다시 실행할 수 있습니다.
```
bash ./run_all.sh -f results/20250806_201620/failed_targets.log
```

## ✍️ 새로운 테스트 추가 방법
1. `tests/` 디렉터리 아래에 테스트 목적에 맞는 새로운 디렉터리를 생성합니다.
2. 해당 디렉터리에 테스트를 실행할 `.sh` 스크립트 파일을 작성합니다. 스크립트 내에서는 `lib/common.sh`에 정의된 `run_test_case` 함수를 호출해야 합니다.
3. 테스트의 예상 결과물인 `.answer` 파일을 같은 위치에 생성합니다.
4. 필요에 따라 마이그레이션 설정을 위한 `.xml` 파일이나 비교할 `dump/` 디렉터리를 추가합니다.

